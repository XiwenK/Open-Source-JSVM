在 ORP 中，内存分为三个区 : 被收集的 (collected) 区，被跟踪的 (traced) 的区和不被跟踪的 (untraced) 区

被收集的区 (有时候指的是堆) 分为两个区域 : 年轻对象空间 (YOS) 和成熟对象空间 (MOS) 

垃圾收集的主要功能在于在管理的内存区域内，保存活动对象，回收死对象空间。所谓活动对象，是指在运行期活动代码中有对该对象的引用。直观的，我们可以把它分成两类 : 一类是全局引用;  另外一类，是在活动调用栈上的局部引用。垃圾收集器从这些基本的活动引用集出发，递归的扫描引用 对象内各个引用域，就能够找到所有的活动对象。

它是一种对动态分配内存空间 的自动回收重用机制





内存 - collected 区（堆） - YOS + MOS + LOS

YOS - 分代 - 分 step

MOS - 空间（车厢） - 块 + 记忆集

​	Train 算法：回收 MOS，每次致力于把一条引用链放入同一个车厢并回收，每次回收一个车厢

先扫 YOS 再扫 MOS

记忆集：空间外指向空间内的引用集



**GC初始化：**

堆的物理结构：

- 堆 - 块 - 页
  - 堆大小 32 M，可扩展至 64 M
  - 块大小 64 K，可用块 512 个，可扩展至 1024 个
  - 页大小 4096 B，每个块 16 页
  - 块：3 页 block_info + 13 页数据 
- 堆的逻辑结构
  - YOS
    - step 代
      - 由一定数目的块组成，数目可能发生变化
      - 通常不相邻，nursery 中的块是连续空间
    - 最年轻的 step 被称为 Nursery
  - LOS：存储大对象和不移动的小对象
  - MOS
    - 空间（车厢） =  块 + 记忆集
    - Train 算法：回收 MOS，每次致力于把一条引用链放入同一个车厢并回收，每次回收一个车厢
- 块结构体
  - 块种类：free, nursery, step, mos，每个状态还存在子状态
  - 除 LOS 和 free_block 外，其余块区大小都为 1 个块
  - free_block 初始化：GC 初始化空闲块表时，所有的块都被连到表的第 9 个条目上，这 512 个块形成的块区的代表就是 堆的第一个块
  - Nursery 初始化：nursery 空闲块预设数目是 16 个
  - LOS 初始化：
    - los_bucket：
      - 用一个数组 los_buckets 来记录每个 LOS 块，数组的元素个数是 GC_LOS_BUCKETS（默认为10），LOS 块被分成固定大小的内存段，段的大小对不同的块是不同的，空闲的段用链表连接 起来
    - single_object_blocks：用以访问存放大小超出一个块的对象的块区

